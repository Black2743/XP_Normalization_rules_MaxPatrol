Initial work on new function
More progress on the function
